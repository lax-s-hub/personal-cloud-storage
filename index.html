<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Personal Cloud Storage - AI Powered</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      min-height: 100vh;
      padding: 20px;
    }

    .navbar {
      background: rgba(255,255,255,0.1);
      backdrop-filter: blur(10px);
      padding: 15px 30px;
      border-radius: 10px;
      margin-bottom: 30px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      color: white;
    }

    .navbar h1 {
      font-size: 24px;
    }

    .navbar p {
      font-size: 12px;
      opacity: 0.8;
    }

    .container {
      max-width: 900px;
      margin: 0 auto;
    }

    .upload-card {
      background: white;
      border-radius: 15px;
      padding: 40px;
      box-shadow: 0 20px 60px rgba(0,0,0,0.3);
      margin-bottom: 30px;
    }

    .upload-card h2 {
      color: #333;
      margin-bottom: 20px;
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .upload-area {
      border: 3px dashed #667eea;
      border-radius: 10px;
      padding: 40px;
      text-align: center;
      cursor: pointer;
      transition: all 0.3s;
      background: #f8f9ff;
    }

    .upload-area:hover {
      border-color: #764ba2;
      background: #f0f2ff;
    }

    .upload-area input[type="file"] {
      display: none;
    }

    .upload-area p {
      color: #666;
      margin-bottom: 15px;
      font-size: 14px;
    }

    .btn {
      padding: 12px 30px;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      font-weight: bold;
      font-size: 14px;
      transition: all 0.3s;
      margin: 5px;
    }

    .btn-primary {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
    }

    .btn-primary:hover {
      transform: translateY(-2px);
      box-shadow: 0 10px 20px rgba(102, 126, 234, 0.3);
    }

    .btn-secondary {
      background: #f0f0f0;
      color: #333;
    }

    .btn-secondary:hover {
      background: #e0e0e0;
    }

    .btn-danger {
      background: #ff6b6b;
      color: white;
      padding: 8px 15px;
      font-size: 12px;
    }

    .btn-danger:hover {
      background: #ff5252;
    }

    .stats {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 15px;
      margin-bottom: 30px;
    }

    .stat-card {
      background: white;
      padding: 20px;
      border-radius: 10px;
      text-align: center;
      box-shadow: 0 5px 15px rgba(0,0,0,0.1);
    }

    .stat-card .number {
      font-size: 32px;
      font-weight: bold;
      color: #667eea;
    }

    .stat-card .label {
      color: #999;
      font-size: 12px;
      margin-top: 5px;
    }

    .files-card {
      background: white;
      border-radius: 15px;
      padding: 40px;
      box-shadow: 0 20px 60px rgba(0,0,0,0.3);
    }

    .files-card h2 {
      color: #333;
      margin-bottom: 20px;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .files-list {
      list-style: none;
    }

    .file-item {
      background: #f8f9fa;
      padding: 15px;
      margin-bottom: 10px;
      border-radius: 8px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      transition: all 0.3s;
      border-left: 4px solid #667eea;
    }

    .file-item:hover {
      background: #f0f2ff;
      transform: translateX(5px);
    }

    .file-name {
      display: flex;
      align-items: center;
      gap: 10px;
      flex: 1;
    }

    .file-icon {
      font-size: 20px;
    }

    .file-details {
      color: #999;
      font-size: 12px;
    }

    .empty-state {
      text-align: center;
      padding: 40px;
      color: #999;
    }

    .status {
      padding: 15px;
      border-radius: 8px;
      margin-bottom: 15px;
      display: none;
      animation: slideDown 0.3s ease;
    }

    @keyframes slideDown {
      from {
        opacity: 0;
        transform: translateY(-10px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    .status.success {
      background: #d4edda;
      color: #155724;
      border: 1px solid #c3e6cb;
      display: block;
    }

    .status.error {
      background: #f8d7da;
      color: #721c24;
      border: 1px solid #f5c6cb;
      display: block;
    }

    .loading {
      display: inline-block;
      width: 20px;
      height: 20px;
      border: 3px solid rgba(102, 126, 234, 0.2);
      border-top-color: #667eea;
      border-radius: 50%;
      animation: spin 0.8s linear infinite;
    }

    @keyframes spin {
      to { transform: rotate(360deg); }
    }

    @media (max-width: 768px) {
      .stats {
        grid-template-columns: 1fr;
      }
      
      .upload-card, .files-card {
        padding: 20px;
      }
    }
  </style>
</head>
<body>
  <div class="navbar">
    <div>
      <h1>☁️ Personal Cloud Storage</h1>
      <p>AI-Powered File Management System</p>
    </div>
  </div>

  <div class="container">
    <!-- Statistics -->
    <div class="stats">
      <div class="stat-card">
        <div class="number" id="totalFiles">0</div>
        <div class="label">Total Files</div>
      </div>
      <div class="stat-card">
        <div class="number" id="totalSize">0</div>
        <div class="label">Storage Used</div>
      </div>
      <div class="stat-card">
        <div class="number" id="uploadStatus">Ready</div>
        <div class="label">Status</div>
      </div>
    </div>

    <!-- Upload Section -->
    <div class="upload-card">
      <h2>📤 Upload Files</h2>
      
      <div id="status" class="status"></div>

      <div class="upload-area" onclick="document.getElementById('fileInput').click()">
        <input type="file" id="fileInput" multiple />
        <p style="font-size: 48px; margin-bottom: 10px;">📁</p>
        <p><strong>Click to upload or drag and drop</strong></p>
        <p style="color: #999; font-size: 12px;">SVG, PNG, JPG, PDF or any file</p>
      </div>

      <div style="margin-top: 20px; display: flex; gap: 10px;">
        <button class="btn btn-primary" onclick="uploadFile()">📤 Upload File</button>
        <button class="btn btn-secondary" onclick="loadFiles()">🔄 Refresh List</button>
        <button class="btn btn-secondary" onclick="clearStatus()">✕ Clear Status</button>
      </div>
    </div>

    <!-- Files List Section -->
    <div class="files-card">
      <h2>
        <span>📁 Your Files</span>
        <span style="font-size: 14px; font-weight: normal; color: #999;" id="fileCount">(0 files)</span>
      </h2>

      <ul class="files-list" id="fileList">
        <li class="empty-state">
          <p>📭 No files uploaded yet</p>
          <p style="font-size: 12px; margin-top: 5px;">Upload your first file to get started!</p>
        </li>
      </ul>
    </div>
  </div>

  <script>
    // Show status message
    function showStatus(message, type) {
      const status = document.getElementById('status');
      status.textContent = message;
      status.className = `status ${type}`;
      
      setTimeout(() => {
        if (type === 'success') {
          clearStatus();
        }
      }, 4000);
    }

    function clearStatus() {
      document.getElementById('status').className = 'status';
      document.getElementById('status').textContent = '';
    }

    // Upload file
    async function uploadFile() {
      const file = document.getElementById('fileInput').files[0];
      
      if (!file) {
        showStatus('❌ Please select a file first!', 'error');
        return;
      }

      // Show loading state
      const uploadBtn = event.target;
      uploadBtn.disabled = true;
      uploadBtn.innerHTML = '<span class="loading"></span> Uploading...';

      const formData = new FormData();
      formData.append('file', file);

      try {
        const response = await fetch('http://localhost:5000/api/upload', {
          method: 'POST',
          body: formData
        });

        const data = await response.json();

        if (data.success) {
          showStatus(`✅ File uploaded: ${data.file.originalName} (${formatSize(data.file.size)})`, 'success');
          document.getElementById('fileInput').value = '';
          loadFiles();
        } else {
          showStatus('❌ Upload failed!', 'error');
        }
      } catch (error) {
        showStatus(`❌ Error: ${error.message}`, 'error');
      } finally {
        uploadBtn.disabled = false;
        uploadBtn.innerHTML = '📤 Upload File';
      }
    }

    // Load files list
    async function loadFiles() {
      try {
        const response = await fetch('http://localhost:5000/api/files');
        const data = await response.json();

        const fileList = document.getElementById('fileList');
        const fileCount = document.getElementById('fileCount');
        const totalFiles = document.getElementById('totalFiles');

        totalFiles.textContent = data.totalFiles || 0;
        fileCount.textContent = `(${data.totalFiles || 0} files)`;

        fileList.innerHTML = '';

        if (data.files.length === 0) {
          fileList.innerHTML = `
            <li class="empty-state">
              <p>📭 No files uploaded yet</p>
              <p style="font-size: 12px; margin-top: 5px;">Upload your first file to get started!</p>
            </li>
          `;
        } else {
          data.files.forEach(file => {
            const li = document.createElement('li');
            li.className = 'file-item';
            li.innerHTML = `
              <div class="file-name">
                <span class="file-icon">${getFileIcon(file)}</span>
                <div>
                  <div style="color: #333; font-weight: 500;">${file}</div>
                  <div class="file-details">Uploaded recently</div>
                </div>
              </div>
              <button class="btn btn-danger" onclick="deleteFile('${file}')">🗑️ Delete</button>
            `;
            fileList.appendChild(li);
          });
        }
      } catch (error) {
        showStatus(`❌ Error loading files: ${error.message}`, 'error');
      }
    }

    // Delete file
    async function deleteFile(filename) {
      if (!confirm(`Delete "${filename}"?`)) return;

      try {
        const response = await fetch(`http://localhost:5000/api/files/${filename}`, {
          method: 'DELETE'
        });

        const data = await response.json();

        if (data.success) {
          showStatus(`✅ Deleted: ${filename}`, 'success');
          loadFiles();
        }
      } catch (error) {
        showStatus(`❌ Error: ${error.message}`, 'error');
      }
    }

    // Helper functions
    function getFileIcon(filename) {
      const ext = filename.split('.').pop().toLowerCase();
      const icons = {
        'pdf': '📄', 'doc': '📝', 'docx': '📝',
        'xls': '📊', 'xlsx': '📊',
        'jpg': '🖼️', 'jpeg': '🖼️', 'png': '🖼️', 'gif': '🖼️',
        'mp4': '🎬', 'avi': '🎬', 'mov': '🎬',
        'mp3': '🎵', 'wav': '🎵',
        'zip': '📦', 'rar': '📦',
        'txt': '📄', 'csv': '📊'
      };
      return icons[ext] || '📎';
    }

    function formatSize(bytes) {
      if (bytes === 0) return '0 Bytes';
      const k = 1024;
      const sizes = ['Bytes', 'KB', 'MB', 'GB'];
      const i = Math.floor(Math.log(bytes) / Math.log(k));
      return Math.round(bytes / Math.pow(k, i) * 100) / 100 + ' ' + sizes[i];
    }

    // Load files on page load
    loadFiles();

    // Drag and drop support
    const uploadArea = document.querySelector('.upload-area');
    
    uploadArea.addEventListener('dragover', (e) => {
      e.preventDefault();
      uploadArea.style.borderColor = '#764ba2';
      uploadArea.style.background = '#f0f2ff';
    });

    uploadArea.addEventListener('dragleave', () => {
      uploadArea.style.borderColor = '#667eea';
      uploadArea.style.background = '#f8f9ff';
    });

    uploadArea.addEventListener('drop', (e) => {
      e.preventDefault();
      document.getElementById('fileInput').files = e.dataTransfer.files;
      uploadFile();
    });
  </script>
</body>
</html>
